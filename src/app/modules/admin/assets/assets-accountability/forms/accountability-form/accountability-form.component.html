<!-- Add this loader somewhere in your template -->
<div *ngIf="loading" class="loader">
    <img
        class="-mb-5"
        style="height: 65px; width: 65px"
        src="assets/images/logo/favicon-192x192.png"
        alt="It Assets Logo"
    />
    <div class="spinner w-16">
        <div class="bounce1"></div>
        <div class="bounce2"></div>
        <div class="bounce3"></div>
    </div>
</div>

<div *ngIf="!loading" class="mx-auto">
    <div
        *ngIf="asset"
        class="inset-0 min-w-0 text-center overflow-auto print:overflow-visible"
        cdkScrollable
    >
        <!-- A4 Wrapper -->
        <div class="a4-container">
            <!-- Page Content -->
            <div class="inline-block p-6 sm:p-10 text-left print:p-0">
                <div
                    class="w-240 min-w-240 p-16 rounded-2xl shadow bg-card print:w-auto print:p-0 print:rounded-none print:shadow-none print:bg-transparent"
                >
                    <div id="pdfFormArea" #pdfFormArea>
                        <div class="flex">
                            <div class="flex flex-row gap-4 w-full">
                                <div class="flex gap-4">
                                    <img
                                        src="assets/images/logo/abfilogo.png"
                                        alt="Logo"
                                        class="-ml-5 -mt-5 h-32 w-32"
                                    />
                                    <div class="flex flex-col w-64 gap-1">
                                        <p class="font-bold text-sm">
                                            Ana's Breeders Farm Inc.
                                        </p>
                                        <p class="text-sm w-56">
                                            Sitio Sto. Niño, Pan Philippine
                                            Highway Brgy. Binugao, Toril
                                            District Davao City, Davao del Sur,
                                            Philippines.
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <!-- Right-aligned Document Details -->
                            <div class="flex flex-row gap-4 w-full justify-end">
                                <div class="flex flex-col w-64 gap-1 items-end">
                                    <p class="font-bold text-sm">
                                        Control Number
                                        <span class="font-medium">{{
                                            asset?.user_accountability_list
                                                .accountability_code
                                        }}</span>
                                        <!-- -
                                        <span class="font-medium">{{
                                            asset?.user_accountability_list.id
                                        }}</span> -->
                                    </p>
                                    <p class="font-bold text-sm">
                                        Effective Date
                                        <span class="font-medium">{{
                                            asset?.user_accountability_list
                                                .date_created
                                                ? (asset
                                                      ?.user_accountability_list
                                                      .date_created
                                                  | date : "MMMM d, y")
                                                : "-"
                                        }}</span>
                                    </p>
                                </div>
                            </div>
                        </div>

                        <p
                            class="flex justify-center text-2xl font-semibold w-full"
                        >
                            ACCOUNTABILITY FORM
                        </p>

                        <div
                            class="flex flex-row justify-between w-full mx-auto mt-8 gap-12 uppercase"
                        >
                            <div class="flex flex-col gap-0.5 w-58">
                                <p class="text-md tracking-tight font-bold">
                                    ISSUED TO
                                </p>

                                <div class="flex flex-row gap-2 text-xs">
                                    <p
                                        class="text-regular tracking-tight font-bold"
                                    >
                                        Employee Name
                                    </p>
                                    <span class="font-medium">{{
                                        asset.user_accountability_list.owner
                                            .name || "-"
                                    }}</span>
                                </div>

                                <div class="flex flex-row gap-10 text-xs">
                                    <p
                                        class="text-regular tracking-tight font-bold"
                                    >
                                        ID Number
                                    </p>
                                    <span class="font-medium">
                                        {{
                                            asset.user_accountability_list.owner
                                                .employee_id || "-"
                                        }}
                                    </span>
                                </div>

                                <div class="flex flex-row gap-7 text-xs">
                                    <p
                                        class="text-regular tracking-tight font-bold"
                                    >
                                        Designation
                                    </p>
                                    <span class="font-medium">
                                        {{
                                            asset.user_accountability_list.owner
                                                .designation || "-"
                                        }}
                                    </span>
                                </div>
                            </div>

                            <div class="flex flex-col gap-0.5 w-52 mt-7">
                                <div class="flex flex-row justify-between text-xs">
                                    <p
                                        class="text-regular tracking-tight font-bold"
                                    >
                                        Business Unit
                                    </p>
                                    <span class="font-medium">
                                        {{
                                            asset.user_accountability_list.owner
                                                .company || "-"
                                        }}
                                    </span>
                                </div>

                                <div class="flex flex-row justify-between text-xs">
                                    <p
                                        class="text-regular tracking-tight font-bold"
                                    >
                                        Department
                                    </p>
                                    <span class="font-medium">
                                        {{
                                            asset.user_accountability_list.owner
                                                .department || "-"
                                        }}
                                    </span>
                                </div>
                                <div class="flex flex-row justify-between text-xs">
                                    <p
                                        class="text-regular tracking-tight font-bold"
                                    >
                                        Date Hired
                                    </p>
                                    <span class="font-medium">
                                        {{
                                            asset.user_accountability_list.owner
                                                .date_hired
                                                ? (asset
                                                      .user_accountability_list
                                                      .owner.date_hired?.value
                                                  | date : "MMMM d, y")
                                                : "-"
                                        }}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Page Break (If Needed) -->
                        <div class="page-break"></div>
                        <div class="flex flex-col my-4">
                            <p class="text-sm font-semibold mt-5">
                                Computer under accountability
                            </p>
                        </div>
                        <!-- Table -->
                        <div class="overflow-x-auto">
                            <mat-table
                                [dataSource]="dataSourceComputers"
                                matSort
                                class="mat-elevation-z8 custom-mat-table compact-table"
                            >
                                >
                                <!-- Type Column -->
                                <ng-container matColumnDef="type">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Type</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let e"
                                        >{{
                                            e.type === "CPU"
                                                ? "DESKTOP"
                                                : e.type || "-"
                                        }}
                                    </mat-cell>
                                </ng-container>
                                <ng-container matColumnDef="dateAcquired">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        class="-ml-7"
                                        >Date Acquired</mat-header-cell
                                    >
                                    <mat-cell *matCellDef="let e" class="-ml-7">
                                        {{
                                            isValidDate(e.date_acquired)
                                                ? (e.date_acquired
                                                  | date : "MMMM d, y")
                                                : "-"
                                        }}
                                    </mat-cell>
                                </ng-container>
                                <ng-container
                                    matColumnDef="assetBarcode"
                                    class="-ml-5"
                                >
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Inventory Code</mat-header-cell
                                    >
                                    <mat-cell *matCellDef="let e">{{
                                        e.asset_barcode || "-"
                                    }}</mat-cell>
                                </ng-container>
                                <ng-container matColumnDef="brand">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Brand</mat-header-cell
                                    >
                                    <mat-cell *matCellDef="let e">{{
                                        e.brand || "-"
                                    }}</mat-cell>
                                </ng-container>
                                <ng-container matColumnDef="model">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Model</mat-header-cell
                                    >
                                    <mat-cell *matCellDef="let e">{{
                                        e.model || "-"
                                    }}</mat-cell>
                                </ng-container>
                                <ng-container matColumnDef="personalHistory">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        style="
                                            white-space: normal;
                                            font-size: 11px;
                                        "
                                        >History</mat-header-cell
                                    >
                                    <mat-cell *matCellDef="let e">
                                        {{
                                            e.history?.$values?.length
                                                ? e.history.$values.join(", ")
                                                      .length > 50
                                                    ? e.history.$values
                                                          .join(", ")
                                                          .substring(0, 50) +
                                                      "..."
                                                    : e.history.$values.join(
                                                          ", "
                                                      )
                                                : "-"
                                        }}
                                    </mat-cell>
                                </ng-container>
                                <ng-container matColumnDef="status">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Status</mat-header-cell
                                    >
                                    <mat-cell *matCellDef="let e">{{
                                        e.status || "-"
                                    }}</mat-cell>
                                </ng-container>
                                <mat-header-row
                                    *matHeaderRowDef="displayedColumns"
                                ></mat-header-row>
                                <mat-row
                                    *matRowDef="
                                        let row;
                                        columns: displayedColumns
                                    "
                                    class="hover:bg-gray-100 cursor-pointer mat-row-compact"
                                    [routerLink]="[
                                        '/assets/computers/view/' + row.id
                                    ]"
                                ></mat-row>
                            </mat-table>
                        </div>

                        <div class="flex flex-col my-4">
                            <p class="text-sm font-semibold mt-5">
                                Computer Components under accountability
                            </p>
                        </div>

                        <div class="overflow-x-auto">
                            <mat-table
                                [dataSource]="dataSourceAssignedComponents"
                                matSort
                                class="mat-elevation-z8 custom-mat-table compact-table"
                            >
                                >
                                <!-- Type Column -->
                                <ng-container matColumnDef="type">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Type</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >{{ element.type || "-" }}</mat-cell
                                    >
                                </ng-container>

                                <ng-container matColumnDef="date_acquired">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Date Acquired</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                    >
                                        {{
                                            isValidDate(element.date_acquired)
                                                ? (element.date_acquired
                                                  | date : "MMMM d, y")
                                                : "-"
                                        }}
                                    </mat-cell>
                                </ng-container>

                                <!-- Description Column -->
                                <ng-container matColumnDef="description">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Description</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >{{
                                            element.description || "-"
                                        }}</mat-cell
                                    >
                                </ng-container>

                                <!-- UID Column -->
                                <ng-container matColumnDef="uid">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                    >
                                        Inventory Code
                                    </mat-header-cell>
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                    >
                                        {{ element.uid }}
                                    </mat-cell>
                                </ng-container>

                                <ng-container matColumnDef="parent_barcode">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Parent Invt. Code</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >{{
                                            element.asset_barcode || "-"
                                        }}</mat-cell
                                    >
                                </ng-container>
                                <ng-container matColumnDef="status">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Status</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >{{ element.status || "-" }}</mat-cell
                                    >
                                </ng-container>
                                <ng-container matColumnDef="cost">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >cost</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >₱ {{ element.cost || "-" }}</mat-cell
                                    >
                                </ng-container>

                                <!-- Header and Rows -->
                                <mat-header-row
                                    *matHeaderRowDef="[
                                        'type',
                                        'date_acquired',
                                        'uid',
                                        'description',

                                        'parent_barcode',
                                        'status'
                                    ]"
                                ></mat-header-row>
                                <mat-row
                                    *matRowDef="
                                        let row;
                                        columns: [
                                            'type',
                                            'date_acquired',
                                            'uid',
                                            'description',

                                            'parent_barcode',
                                            'status'
                                        ]
                                    "
                                    class="hover:bg-gray-100 cursor-pointer"
                                    [routerLink]="[
                                        '/assets/components/view/',
                                        row.uid,
                                        row.id
                                    ]"
                                ></mat-row>
                            </mat-table>
                        </div>

                        <div class="flex flex-col my-4">
                            <p class="text-sm font-semibold mt-5">
                                Peripherals under accountability
                            </p>
                        </div>

                        <div class="overflow-x-auto">
                            <mat-table
                                [dataSource]="dataSourceAssignedAssets"
                                matSort
                                class="mat-elevation-z8 custom-mat-table compact-table"
                            >
                                >
                                <!-- Type Column -->
                                <ng-container matColumnDef="type">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Type</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >{{ element.type || "-" }}</mat-cell
                                    >
                                </ng-container>

                                <!-- Date Acquired Column -->
                                <ng-container matColumnDef="dateAcquired">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        class="-ml-5"
                                        >Date Acquired</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        class="-ml-5"
                                    >
                                        {{
                                            isValidDate(element.date_acquired)
                                                ? (element.date_acquired
                                                  | date : "MMMM d, y")
                                                : "-"
                                        }}
                                    </mat-cell>
                                </ng-container>

                                <!-- Asset Barcode Column -->
                                <ng-container matColumnDef="assetBarcode">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                    >
                                        Inventory Code</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >{{
                                            element.asset_barcode || "-"
                                        }}</mat-cell
                                    >
                                </ng-container>

                                <!-- Brand Column -->
                                <ng-container matColumnDef="brand">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Brand</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >{{ element.brand || "-" }}</mat-cell
                                    >
                                </ng-container>

                                <!-- Model Column -->
                                <ng-container matColumnDef="model">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Model</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >{{ element.model || "-" }}</mat-cell
                                    >
                                </ng-container>

                                <!-- Asset Personal History Column -->
                                <ng-container matColumnDef="personalHistory">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        style="
                                            width: 600px;
                                            white-space: normal;
                                        "
                                    >
                                        History
                                    </mat-header-cell>
                                    <mat-cell
                                        class="text-sm truncate"
                                        *matCellDef="let element"
                                        style="
                                            width: 600px;
                                            white-space: normal;
                                        "
                                    >
                                        {{
                                            element.history?.$values?.length
                                                ? element.history.$values.join(
                                                      ", "
                                                  ).length > 50
                                                    ? element.history.$values
                                                          .join(", ")
                                                          .substring(0, 50) +
                                                      "..."
                                                    : element.history.$values.join(
                                                          ", "
                                                      )
                                                : "-"
                                        }}
                                    </mat-cell>
                                </ng-container>

                                <!-- Status Column -->
                                <ng-container matColumnDef="status">
                                    <mat-header-cell
                                        *matHeaderCellDef
                                        mat-sort-header
                                        >Status</mat-header-cell
                                    >
                                    <mat-cell
                                        class="text-sm"
                                        *matCellDef="let element"
                                        >{{ element.status || "-" }}</mat-cell
                                    >
                                </ng-container>

                                <!-- Header and Rows -->
                                <mat-header-row
                                    *matHeaderRowDef="displayedColumns"
                                ></mat-header-row>
                                <mat-row
                                    *matRowDef="
                                        let row;
                                        columns: displayedColumns
                                    "
                                    class="hover:bg-gray-100 cursor-pointer"
                                    [routerLink]="
                                        '/assets/inventory/view/' + row.id
                                    "
                                >
                                </mat-row>
                            </mat-table>
                        </div>
                        <div
                            class="flex flex-col w-full gap-4 mt-8 text-xs text-justify"
                        >
                            <p>
                                I HEREBY ACKNOWLEDGE RECEIPT OF AND ACCEPT
                                RESPONSIBILITY OF THE ABOVE ASSETS ISSUED TO ME
                                IN ACCORDANCE WITH THE COMPANY POLICY AND
                                PROCEDURES. UPON SEPARATION FROM THE COMPANY, I
                                WILL RETURN THE ITEM(S) ISSUED TO ME IN GOOD
                                WORKING CONDITION (SUBJECT TO ASSESSMENT OF
                                ASSET'S WEAR AND TEAR).
                            </p>
                            <p>
                                FURTHER UNDERSTAND THAT THE ISSUED ASSET(S)
                                IS/ARE FOR COMPANY USE ONLY AND FAILURE TO
                                COMPLY WITH THE COMPANY POLICY AND PROCEDURES
                                WILL BE SUBJECTED TO DISCIPLINARY ACTION. WITH
                                PROPER INVESTIGATION, ANY DAMAGES OR LOSS DUE TO
                                MY NEGLIGENCE WILL BE AUTOMATICALLY CHARGED
                                AND/OR DEDUCTED TO MY SALARY.
                            </p>
                        </div>

                        <div
                            class="grid grid-cols-3 w-full gap-4 mt-12 lg:flex-row md:flex-row"
                        >
                            <!-- COLUMN 1: PREPARED BY -->
                            <div class="my-6">
                                <p
                                    class="text-sm tracking-tight font-bold uppercase"
                                >
                                    Prepared by:
                                </p>

                                <!-- Signature Image -->
                                <div class="flex-grow text-start">
                                    <div class="flex justify-start items-start">
                                        <ng-container
                                            *ngIf="
                                                accountabilityApproval?.preparedByUser;
                                                else blankSignature
                                            "
                                        >
                                            <img
                                                *ngIf="
                                                    accountabilityApproval
                                                        ?.preparedByUser
                                                        ?.e_signature;
                                                    else defaultSignature
                                                "
                                                [src]="
                                                    getSignatureUrl(
                                                        accountabilityApproval
                                                            ?.preparedByUser
                                                            ?.e_signature
                                                    )
                                                "
                                                alt="Signature"
                                                class="mt-4 h-20 w-48 opacity-50"
                                            />
                                        </ng-container>
                                    </div>

                                    <!-- Default Signature Placeholder -->
                                    <ng-template #defaultSignature>
                                        <img
                                            src="assets/images/logo/signature.png"
                                            alt="Default Signature"
                                            class="mt-4 w-48 opacity-50"
                                        />
                                    </ng-template>

                                    <!-- Blank Image Placeholder -->
                                    <ng-template #blankSignature>
                                        <img
                                            src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                                            alt="Blank Signature"
                                            class="mt-4 w-20 opacity-0"
                                        />
                                    </ng-template>

                                    <!-- Show Name & Role -->
                                    <div class="flex flex-row gap-8 uppercase">
                                        <div class="flex flex-col w-48">
                                            <p
                                                class="text-md border-t m-1 text-center items-center"
                                            >
                                                {{
                                                    accountabilityApproval
                                                        ?.preparedByUser?.name
                                                        ? accountabilityApproval
                                                              .preparedByUser
                                                              .name
                                                        : user?.role ===
                                                              "receiver" ||
                                                          user?.role ===
                                                              "checker"
                                                        ? user?.name
                                                        : "NOT AVAILABLE"
                                                }}
                                            </p>

                                            <span
                                                class="text-sm text-gray-600 text-center items-center"
                                            >
                                                {{
                                                    accountabilityApproval
                                                        ?.preparedByUser
                                                        ?.designation
                                                        ? accountabilityApproval
                                                              .preparedByUser
                                                              .designation
                                                        : user?.role ===
                                                              "receiver" ||
                                                          user?.role ===
                                                              "checker"
                                                        ? user?.designation
                                                        : "IT/OT OPERATIONS"
                                                }}
                                            </span>

                                            <!-- Date in a separate element -->
                                            <div
                                                class="text-xs tracking-tight font-bold uppercase text-center mt-2"
                                            >
                                                Date
                                                <span class="font-medium">
                                                    {{
                                                        accountabilityApproval?.prepared_date
                                                            ? (accountabilityApproval.prepared_date
                                                              | date
                                                                  : "MMMM d, y")
                                                            : "-"
                                                    }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- COLUMN 2: APPROVED BY -->
                            <div class="grid grid-cols-1 my-6">
                                <div class="flex-grow text-start">
                                    <div class="flex flex-row gap-8">
                                        <p
                                            class="text-sm tracking-tight font-bold uppercase"
                                        >
                                            Approved By:
                                        </p>
                                    </div>

                                    <div class="flex justify-start items-start">
                                        <ng-container
                                            *ngIf="
                                                accountabilityApproval?.approvedByUser;
                                                else blankSignature
                                            "
                                        >
                                            <img
                                                *ngIf="
                                                    accountabilityApproval
                                                        ?.approvedByUser
                                                        ?.e_signature;
                                                    else defaultSignature
                                                "
                                                [src]="
                                                    getSignatureUrl(
                                                        accountabilityApproval
                                                            ?.approvedByUser
                                                            ?.e_signature
                                                    )
                                                "
                                                alt="Signature"
                                                class="mt-4 h-20 w-48 opacity-50"
                                            />
                                        </ng-container>
                                    </div>

                                    <ng-template #defaultSignature>
                                        <img
                                            src="assets/images/logo/signature.png"
                                            alt="Default Signature"
                                            class="mt-4 w-48 opacity-50"
                                        />
                                    </ng-template>

                                    <!-- Blank Image Placeholder -->
                                    <ng-template #blankSignature>
                                        <img
                                            src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                                            alt="Blank Signature"
                                            class="mt-4 w-20 opacity-0"
                                        />
                                    </ng-template>

                                    <div class="flex flex-row gap-8 uppercase">
                                        <div class="flex flex-col w-48">
                                            <p
                                                class="text-md border-t m-1 text-center items-center"
                                            >
                                                {{
                                                    accountabilityApproval
                                                        ?.approvedByUser?.name
                                                        ? accountabilityApproval
                                                              .approvedByUser
                                                              .name
                                                        : user?.role === "admin"
                                                        ? user.name
                                                        : "NOT AVAILABLE"
                                                }}
                                            </p>

                                            <span
                                                class="text-sm text-gray-600 text-center items-center"
                                            >
                                                {{
                                                    accountabilityApproval
                                                        ?.approvedByUser
                                                        ?.designation
                                                        ? accountabilityApproval
                                                              .approvedByUser
                                                              .designation
                                                        : user?.role === "admin"
                                                        ? user?.designation
                                                        : "IT MANAGER"
                                                }}
                                            </span>

                                            <!-- Date in a separate element -->
                                            <div
                                                class="text-xs tracking-tight font-bold uppercase text-center mt-2"
                                            >
                                                Date
                                                <span class="font-medium">
                                                    {{
                                                        accountabilityApproval?.approved_date
                                                            ? (accountabilityApproval.approved_date
                                                              | date
                                                                  : "MMMM d, y")
                                                            : "-"
                                                    }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- COLUMN 3: RECEIVED BY -->
                            <div class="flex-grow flex-col my-6">
                                <div class="flex-grow text-start">
                                    <div class="flex flex-row gap-8">
                                        <p
                                            class="text-sm tracking-tight font-bold uppercase"
                                        >
                                            Received By:
                                        </p>
                                    </div>

                                    <div
                                        class="flex justify-start items-start mt-2"
                                    >
                                        <img
                                            src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                                            alt="Blank Signature"
                                            class="mt-4 w-20 opacity-0"
                                        />
                                    </div>

                                    <div class="flex flex-row gap-12 uppercase">
                                        <div class="flex flex-col w-48">
                                            <p
                                                class="text-md border-t text-center"
                                            >
                                                {{
                                                    asset
                                                        .user_accountability_list
                                                        .owner.name || "-"
                                                }}
                                            </p>
                                            <span
                                                class="text-sm text-gray-600 text-center items-center"
                                            >
                                                {{
                                                    asset
                                                        .user_accountability_list
                                                        .owner.designation ||
                                                        "-"
                                                }}
                                            </span>

                                            <!-- Date in a separate element -->
                                            <div
                                                class="text-xs tracking-tight font-bold uppercase text-center mt-2"
                                            >
                                                Date
                                                <span class="font-medium">
                                                    {{
                                                        datenow
                                                            ? (datenow
                                                              | date
                                                                  : "MMMM d, y")
                                                            : "-"
                                                    }}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="fixed bottom-4 right-4 flex flex-col space-y-4">
                <!-- Prepare Document Button: Only visible if no preparedByUser signature -->
                <button
                    *ngIf="
                        user?.role !== 'admin' &&
                        !accountabilityApproval?.preparedByUser?.e_signature
                    "
                    class="bg-white shadow-lg flex items-center justify-center hover:bg-blue-50 p-2 rounded-full transition-colors"
                    (click)="preparedByUser()"
                    matTooltip="Prepare Document"
                    matTooltipPosition="above"
                    aria-label="Prepare document"
                    style="width: 56px; height: 56px"
                >
                    <mat-icon
                        svgIcon="verified"
                        class="text-gray-500"
                    ></mat-icon>
                </button>

                <!-- Approve Document Button: Only visible if preparedByUser has data -->
                <button
                    *ngIf="
                        user?.role === 'admin' &&
                        accountabilityApproval?.preparedByUser?.e_signature &&
                        !accountabilityApproval?.approvedByUser?.e_signature
                    "
                    class="bg-white shadow-lg flex items-center justify-center hover:bg-blue-50 p-2 rounded-full transition-colors"
                    (click)="approvedByUser()"
                    matTooltip="Approve Document"
                    matTooltipPosition="above"
                    aria-label="Approve document"
                    style="width: 56px; height: 56px"
                >
                    <mat-icon
                        svgIcon="verified"
                        class="text-green-500"
                    ></mat-icon>
                </button>

                <!-- Download PDF Button -->
                <button
                    class="bg-white shadow-lg flex items-center justify-center hover:bg-blue-50 p-2 rounded-full transition-colors"
                    (click)="pdfForm()"
                    matTooltip="Download Accountability Form"
                    matTooltipPosition="above"
                    aria-label="Generate PDF form"
                    style="width: 56px; height: 56px"
                >
                    <img
                        class="h-8 w-6"
                        src="assets/images/svgs/pdf-svgrepo-com.svg"
                    />
                </button>
            </div>
        </div>
        <div></div>
    </div>
</div>
