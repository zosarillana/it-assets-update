<div
    class="mx-auto inset-0 min-w-0 text-center overflow-auto print:overflow-visible"
    cdkScrollable
>
    <div class="a4-container">
        <div class="inline-block p-6 sm:p-10 text-left print:p-0">
            <div
                class="w-240 min-w-240 p-16 rounded-2xl shadow bg-card print:w-auto print:p-0 print:rounded-none print:shadow-none print:bg-transparent"
            >
                <div id="pdfFormArea" #pdfFormArea>
                    <div class="flex">
                        <div class="flex flex-row gap-4 w-full">
                            <div class="flex gap-4">
                                <img
                                    src="assets/images/logo/suylogo.png"
                                    alt="Logo"
                                    class="-ml-5 -mt-5 h-32 w-32"
                                />
                                <div class="flex flex-col w-64 gap-1">
                                    <p class="font-bold text-sm">
                                        Ana's Breeders Farm Inc.
                                    </p>
                                    <p class="text-sm w-56">
                                        Sitio Sto. Ni√±o, Pan Philippine Highway
                                        Brgy. Binugao, Toril District Davao
                                        City, Davao del Sur, Philippines.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- Right-aligned Document Details -->
                        <div class="flex flex-row gap-4 w-full justify-end">
                            <div class="flex flex-col w-64 gap-1 items-end">
                                <p class="font-bold text-sm">
                                    Document Number
                                    <span class="font-medium">A-60-FR-009</span>
                                </p>
                                <p class="font-bold text-sm">
                                    Effective Date
                                    <!-- <span class="font-medium">{{
                                asset?.user_accountability_list.date_created
                                    ? (asset?.user_accountability_list
                                          .date_created
                                      | date : "MMMM d, y")
                                    : "N/A"
                            }}</span> -->
                                </p>
                            </div>
                        </div>
                    </div>

                    <p
                        class="flex justify-center text-2xl font-semibold w-full"
                    >
                        RETURN ACCOUNTABILITY FORM
                    </p>

                    <div class="flex flex-row w-full mx-auto mt-8 gap-12 uppercase">
                        <div class="flex flex-col gap-0.5 w-58">
                            <p class="text-lg tracking-tight font-bold">
                                ISSUED TO
                            </p>

                            <div class="flex flex-row gap-2 text-sm">
                                <p
                                    class="text-regular tracking-tight font-bold"
                                >
                                    Employee Name
                                </p>
                                <span class="font-medium">
                                    {{
                                        returnItems[0]?.accountability?.owner
                                            ?.name || "N/A"
                                    }}
                                </span>
                            </div>

                            <div class="flex flex-row gap-10 text-sm">
                                <p
                                    class="text-regular tracking-tight font-bold"
                                >
                                    ID Number
                                </p>
                                <span class="font-medium">
                                    {{
                                        returnItems[0]?.accountability?.owner
                                            ?.employee_id || "N/A"
                                    }}
                                </span>
                            </div>

                            <div class="flex flex-row gap-7 text-sm">
                                <p
                                    class="text-regular tracking-tight font-bold"
                                >
                                    Designation
                                </p>
                                <span class="font-medium">
                                    {{
                                        returnItems[0]?.accountability?.owner
                                            ?.designation || "N/A"
                                    }}
                                </span>
                            </div>
                        </div>

                        <div class="flex flex-col gap-0.5 w-58 mt-7">
                            <div class="flex flex-row gap-15 text-sm">
                                <p
                                    class="text-regular tracking-tight font-bold"
                                >
                                    Company
                                </p>
                                <span class="font-medium">
                                    {{
                                        returnItems[0]?.accountability?.owner
                                            ?.company || "N/A"
                                    }}
                                </span>
                            </div>

                            <div class="flex flex-row gap-11 text-sm">
                                <p
                                    class="text-regular tracking-tight font-bold"
                                >
                                    Department
                                </p>
                                <span class="font-medium">
                                    {{
                                        returnItems[0]?.accountability?.owner
                                            ?.department || "N/A"
                                    }}
                                </span>
                            </div>

                            <div class="flex flex-row gap-9 text-sm">
                                <p
                                    class="text-regular tracking-tight font-bold"
                                >
                                    Business Unit
                                </p>
                                <span class="font-medium">
                                    {{
                                        returnItems[0]?.accountability?.owner
                                            ?.business_unit || "N/A"
                                    }}
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Page Break (If Needed) -->
                    <div class="page-break"></div>
                    <div class="flex flex-col my-4">
                        <p class="text-sm font-semibold mt-5">
                            Computer under accountability
                        </p>
                        <span class="text-secondary text-sm">
                            (Desktop, Laptops, etc..)</span
                        >
                    </div>
                    <div *ngIf="computers.length > 0" class="overflow-x-auto">
                        <mat-table
                            [dataSource]="computers"
                            matSort
                            class="mat-elevation-z8 custom-mat-table"
                        >
                            <!-- Type Column -->
                            <ng-container matColumnDef="type">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >Type</mat-header-cell
                                >
                                <mat-cell
                                    class="text-sm"
                                    *matCellDef="let computer"
                                    >{{
                                        computer.computer?.type || "N/A"
                                    }}</mat-cell
                                >
                            </ng-container>

                            <!-- Model Column -->
                            <ng-container matColumnDef="model">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >Model</mat-header-cell
                                >
                                <mat-cell *matCellDef="let computer">{{
                                    computer.computer?.model || "N/A"
                                }}</mat-cell>
                            </ng-container>

                            <!-- Barcode Column -->
                            <ng-container matColumnDef="assetBarcode">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >Barcode</mat-header-cell
                                >
                                <mat-cell *matCellDef="let computer">{{
                                    computer.computer?.asset_barcode || "N/A"
                                }}</mat-cell>
                            </ng-container>

                            <!-- Remarks Column -->
                            <ng-container matColumnDef="remarks">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >Remarks</mat-header-cell
                                >
                                <mat-cell *matCellDef="let computer">{{
                                    computer.remarks || "N/A"
                                }}</mat-cell>
                            </ng-container>

                            <!-- Status Column -->
                            <ng-container matColumnDef="status">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >Status</mat-header-cell
                                >
                                <mat-cell *matCellDef="let computer">{{
                                    computer.status || "N/A"
                                }}</mat-cell>
                            </ng-container>

                            <mat-header-row
                                *matHeaderRowDef="[
                                    'type',
                                    'model',
                                    'assetBarcode',
                                    'remarks',
                                    'status'
                                ]"
                            ></mat-header-row>
                            <mat-row
                                *matRowDef="
                                    let row;
                                    columns: [
                                        'type',
                                        'model',
                                        'assetBarcode',
                                        'remarks',
                                        'status'
                                    ]
                                "
                                class="hover:bg-gray-100 h-12 cursor-pointer"
                            ></mat-row>
                        </mat-table>
                    </div>

                    <div class="overflow-x-auto"></div>

                    <div class="flex flex-col my-4">
                        <p class="text-sm font-semibold mt-5">
                            Computer Components under accountability
                        </p>
                        <span class="text-secondary text-sm"
                            >(Ram, ssd, hdd ...)</span
                        >
                    </div>

                    <div *ngIf="components.length > 0" class="overflow-x-auto">
                        <mat-table
                            [dataSource]="components"
                            matSort
                            class="mat-elevation-z8 custom-mat-table"
                        >
                            <!-- Type Column -->
                            <ng-container matColumnDef="type">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >Type</mat-header-cell
                                >
                                <mat-cell
                                    class="text-sm"
                                    *matCellDef="let component"
                                    >{{
                                        component.components?.type || "N/A"
                                    }}</mat-cell
                                >
                            </ng-container>

                            <!-- UID Column -->
                            <ng-container matColumnDef="uid">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >UID</mat-header-cell
                                >
                                <mat-cell *matCellDef="let component">{{
                                    component.components?.uid || "N/A"
                                }}</mat-cell>
                            </ng-container>

                            <!-- Cost Column -->
                            <ng-container matColumnDef="cost">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >Cost</mat-header-cell
                                >
                                <mat-cell *matCellDef="let component">{{
                                    component.components?.cost || "N/A"
                                }}</mat-cell>
                            </ng-container>

                            <!-- Remarks Column -->
                            <ng-container matColumnDef="remarks">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >Remarks</mat-header-cell
                                >
                                <mat-cell *matCellDef="let component">{{
                                    component.remarks || "N/A"
                                }}</mat-cell>
                            </ng-container>

                            <!-- Status Column -->
                            <ng-container matColumnDef="status">
                                <mat-header-cell
                                    *matHeaderCellDef
                                    mat-sort-header
                                    >Status</mat-header-cell
                                >
                                <mat-cell *matCellDef="let component">{{
                                    component.status || "N/A"
                                }}</mat-cell>
                            </ng-container>

                            <mat-header-row
                                *matHeaderRowDef="[
                                    'type',
                                    'uid',
                                    'cost',
                                    'remarks',
                                    'status'
                                ]"
                            ></mat-header-row>
                            <mat-row
                                *matRowDef="
                                    let row;
                                    columns: [
                                        'type',
                                        'uid',
                                        'cost',
                                        'remarks',
                                        'status'
                                    ]
                                "
                                class="hover:bg-gray-100 h-12 cursor-pointer"
                            ></mat-row>
                        </mat-table>
                    </div>

                    <div class="overflow-x-auto"></div>
                </div>

                <div class="flex flex-col my-4">
                    <p class="text-sm font-semibold mt-5">
                        Assets under accountability
                    </p>
                    <span class="text-secondary text-sm">
                        (Mouse, Keyboards etc..)</span
                    >
                </div>

                <div *ngIf="assets.length > 0" class="overflow-x-auto">
                    <mat-table
                        [dataSource]="assets"
                        matSort
                        class="mat-elevation-z8 custom-mat-table"
                    >
                        <!-- Type Column -->
                        <ng-container matColumnDef="type">
                            <mat-header-cell *matHeaderCellDef mat-sort-header
                                >Type</mat-header-cell
                            >
                            <mat-cell class="text-sm" *matCellDef="let asset">{{
                                asset.asset?.type || "N/A"
                            }}</mat-cell>
                        </ng-container>

                        <!-- Brand Column -->
                        <ng-container matColumnDef="brand">
                            <mat-header-cell *matHeaderCellDef mat-sort-header
                                >Brand</mat-header-cell
                            >
                            <mat-cell *matCellDef="let asset">{{
                                asset.asset?.brand || "N/A"
                            }}</mat-cell>
                        </ng-container>

                        <!-- Barcode Column -->
                        <ng-container matColumnDef="assetBarcode">
                            <mat-header-cell *matHeaderCellDef mat-sort-header
                                >Barcode</mat-header-cell
                            >
                            <mat-cell *matCellDef="let asset">{{
                                asset.asset?.asset_barcode || "N/A"
                            }}</mat-cell>
                        </ng-container>

                        <!-- Remarks Column -->
                        <ng-container matColumnDef="remarks">
                            <mat-header-cell *matHeaderCellDef mat-sort-header
                                >Remarks</mat-header-cell
                            >
                            <mat-cell *matCellDef="let asset">{{
                                asset.remarks || "N/A"
                            }}</mat-cell>
                        </ng-container>

                        <!-- Status Column -->
                        <ng-container matColumnDef="status">
                            <mat-header-cell *matHeaderCellDef mat-sort-header
                                >Status</mat-header-cell
                            >
                            <mat-cell *matCellDef="let asset">{{
                                asset.status || "N/A"
                            }}</mat-cell>
                        </ng-container>

                        <mat-header-row
                            *matHeaderRowDef="[
                                'type',
                                'brand',
                                'assetBarcode',
                                'remarks',
                                'status'
                            ]"
                        ></mat-header-row>
                        <mat-row
                            *matRowDef="
                                let row;
                                columns: [
                                    'type',
                                    'brand',
                                    'assetBarcode',
                                    'remarks',
                                    'status'
                                ]
                            "
                            class="hover:bg-gray-100 h-12 cursor-pointer"
                        ></mat-row>
                    </mat-table>
                </div>

                <div
                id="acknowledgmentSection"
                #acknowledgmentSection
            >
                <div
                    class="flex flex-col w-full gap-4 mt-8 text-sm"
                >
                    <p>
                        I HEREBY ACKNOWLEDGE
                        RECEIPT OF AND ACCEPT
                        RESPONSIBILITY OF THE
                        ABOVE ASSETS ISSUED TO
                        ME IN ACCORDANCE WITH
                        THE COMPANY POLICY AND
                        PROCEDURES. UPON
                        SEPARATION FROM THE
                        COMPANY, I WILL RETURN
                        THE ITEM(S) ISSUED TO ME
                        IN GOOD WORKING
                        CONDITION (SUBJECT TO
                        ASSESMENT OF ASSET'S
                        WEAR AND TEAR).
                    </p>
                    <p>
                        FURTHER UNDERSTAND THAT
                        THE ISSUED ASSET(S)
                        IS/ARE FOR COMPANY USE
                        ONLY AND FAILTURE TO
                        COMPLY WITH THE COMPANY
                        POLICY AND PROCEDURES
                        WILL BE SUBJECTED TO
                        DISCIPLINARY ACTION.
                        WITH PROPER
                        INVESTIGATION, ANY
                        DAMAGES OR LOSS DUE TO
                        MY NEGLIGENCE WILL BE
                        AUTOMATICALLY CHARGED
                        AND/OR DEDUCTED TO MY
                        SALARY.
                    </p>
                </div>

                <div
                    class="grid grid-cols-2 w-full gap-4 mt-12 lg:flex-row md:flex-row"
                >                 
                    <div class="flex-grow text-start">
                        <p class="text-sm tracking-tight font-bold uppercase">
                            Checked by:
                        </p>
                        <div class="flex justify-start items-start">
                            <ng-container
                                *ngIf="
                                    ReturnItemsApproval?.checkedByUser;
                                    else blankSignature
                                "
                            >
                                <img
                                    *ngIf="
                                        ReturnItemsApproval?.checkedByUser
                                            ?.e_signature;
                                        else defaultSignature
                                    "
                                    [src]="
                                        sanitizeImagePath(
                                            ReturnItemsApproval?.checkedByUser
                                                ?.e_signature
                                        )
                                    "
                                    alt="Signature"
                                    class="mt-4 h-20 w-48 opacity-50"
                                />
                            </ng-container>
                        </div>

                        <!-- Default Signature Placeholder -->
                        <ng-template #defaultSignature>
                            <img
                                src="https://www.morebusiness.com/wp-content/uploads/2020/09/handwritten-email-signature.jpg"
                                alt="Default Signature"
                                class="mt-4 w-48 opacity-50"
                            />
                        </ng-template>

                        <!-- Blank Signature Placeholder -->
                        <ng-template #blankSignature>
                            <img
                                src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                                alt="Blank Signature"
                                class="mt-4 w-20 opacity-0"
                            />
                        </ng-template>

                        <!-- Show Name & Role -->
                        <div class="flex flex-row gap-8 -mt-10 uppercase">
                            <div class="flex flex-col w-48">
                                <p
                                    class="text-md border-t m-1 text-center items-center"
                                >
                                  
                                        {{
                                            ReturnItemsApproval
                                            ?.confirmedByUser?.name
                                            ? ReturnItemsApproval
                                            .confirmedByUser
                                            .name
                                            : user?.role ===
                                            "admin"
                                            ? user?.name
                                            : "NOT AVAILABLE"
                                            }}
                                </p>
                                <span
                                    class="text-sm text-gray-600 text-center items-center"
                                >
                                   
                                        {{
                                            ReturnItemsApproval
                                            ?.checkedByUser?.designation
                                            ? ReturnItemsApproval
                                            .checkedByUser
                                            .designation
                                            : user?.role === "admin"
                                            ? user?.designation
                                            : "IT MANAGER"
                                            }}
                                </span>
                            </div>
                            <p
                                class="text-xs tracking-tight font-bold uppercase mt-1.5"
                            >
                                Date
                                <span class="font-medium">
                                    {{
                                        ReturnItemsApproval?.checked_date
                                            ? (ReturnItemsApproval.checked_date
                                              | date : "MMMM d, y")
                                            : "N/A"
                                    }}
                                </span>
                            </p>
                        </div>

                        <div class="flex-grow text-start mt-2">
                            <p class="text-sm tracking-tight font-bold uppercase">
                                Confirmed By:
                            </p>
                            <div class="flex justify-start items-start">
                                <ng-container *ngIf="ReturnItemsApproval?.confirmedByUser; else blankSignature">
                                    <img *ngIf="ReturnItemsApproval?.confirmedByUser?.e_signature; else defaultSignature"
                                        [src]="sanitizeImagePath(ReturnItemsApproval?.confirmedByUser?.e_signature)"
                                        alt="Signature"
                                        class="mt-4 h-20 w-48 opacity-50" />
                                </ng-container>
                            </div>
                        
                            <!-- Default Signature Placeholder -->
                            <ng-template #defaultSignature>
                                <img src="https://www.morebusiness.com/wp-content/uploads/2020/09/handwritten-email-signature.jpg"
                                    alt="Default Signature" class="mt-4 w-48 opacity-50" />
                            </ng-template>
                        
                            <!-- Blank Signature Placeholder -->
                            <ng-template #blankSignature>
                                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                                    alt="Blank Signature" class="mt-4 w-20 opacity-0" />
                            </ng-template>
                        
                            <!-- Show Name & Role -->
                            <div class="flex flex-row gap-8 -mt-10 uppercase">
                                <div class="flex flex-col w-48">
                                    <p class="text-md border-t m-1 text-center items-center">                                      
                                        {{
                                            ReturnItemsApproval
                                            ?.confirmedByUser?.name
                                            ? ReturnItemsApproval
                                            .confirmedByUser
                                            .name
                                            : user?.role ===
                                            "checker"
                                            ? user?.name
                                            : "NOT AVAILABLE"
                                            }}
                                    </p>
                                    <span class="text-sm text-gray-600 text-center items-center">                                      
                                        {{
                                            ReturnItemsApproval
                                            ?.confirmedByUser
                                            ?.designation
                                            ? ReturnItemsApproval
                                            .confirmedByUser
                                            .designation
                                            : user?.role ===
                                            "checker"
                                            ? user?.designation
                                            : "IT/OT END "
                                            }}
                                    </span>
                                </div>
                                <p class="text-xs tracking-tight font-bold uppercase mt-1.5">
                                    Date
                                    <span class="font-medium">
                                        {{ ReturnItemsApproval?.confirmed_date ? (ReturnItemsApproval.confirmed_date | date: "MMMM d, y") : "N/A" }}
                                    </span>
                                </p>
                            </div>
                        </div>          
                    </div>               

                        <div class="flex-grow text-start">
                            <p class="text-sm tracking-tight font-bold uppercase">
                                Received By:
                            </p>
                            <div class="flex justify-start items-start">
                                <ng-container *ngIf="ReturnItemsApproval?.receivedByUser; else blankSignature">
                                    <img *ngIf="ReturnItemsApproval?.receivedByUser?.e_signature; else defaultSignature"
                                        [src]="sanitizeImagePath(ReturnItemsApproval?.receivedByUser?.e_signature)"
                                        alt="Signature"
                                        class="mt-4 h-20 w-48 opacity-50" />
                                </ng-container>
                            </div>
                        
                            <!-- Default Signature Placeholder -->
                            <ng-template #defaultSignature>
                                <img src="https://www.morebusiness.com/wp-content/uploads/2020/09/handwritten-email-signature.jpg"
                                    alt="Default Signature" class="mt-4 w-48 opacity-50" />
                            </ng-template>
                        
                            <!-- Blank Signature Placeholder -->
                            <ng-template #blankSignature>
                                <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                                    alt="Blank Signature" class="mt-4 w-20 opacity-0" />
                            </ng-template>
                        
                            <!-- Show Name & Role -->
                            <div class="flex flex-row gap-8 -mt-10 uppercase">
                                <div class="flex flex-col w-48">
                                    <p class="text-md border-t m-1 text-center items-center">                                      
                                        {{
                                            ReturnItemsApproval
                                            ?.receivedByUser?.name
                                            ? ReturnItemsApproval
                                            .receivedByUser
                                            .name
                                            : user?.role ===
                                            "receiver"
                                            ? user?.name
                                            : "NOT AVAILABLE"
                                            }}
                                    </p>
                                    <span class="text-sm text-gray-600 text-center items-center">                                      
                                        {{
                                            ReturnItemsApproval
                                            ?.receivedByUser
                                            ?.designation
                                            ? ReturnItemsApproval
                                            .receivedByUser
                                            .designation
                                            : user?.role ===
                                            "receiver"
                                            ? user?.designation
                                            : "IT/OT LEAD"
                                            }}
                                    </span>
                                </div>
                                <p class="text-xs tracking-tight font-bold uppercase mt-1.5">
                                    Date
                                    <span class="font-medium">
                                        {{ ReturnItemsApproval?.received_date ? (ReturnItemsApproval.received_date | date: "MMMM d, y") : "N/A" }}
                                    </span>
                                </p>
                            </div>
                        </div>

                </div>
            </div>

        
        </div>
    </div>
    <div class="fixed bottom-4 right-4 flex flex-col space-y-4">
        <button
            *ngIf="user.role === 'receiver'"
            class="bg-white shadow-lg flex items-center justify-center hover:bg-blue-50 p-2 rounded-full transition-colors"
            (click)="receiveByUser()"
            matTooltip="Approve document"
            matTooltipPosition="above"
            aria-label="Approve document"
            style="width: 56px; height: 56px"
        >
            <mat-icon
                svgIcon="verified"
                class="text-blue-500"
            ></mat-icon>
        </button>

        <button
            *ngIf="user.role === 'admin'"
            class="bg-white shadow-lg flex items-center justify-center hover:bg-blue-50 p-2 rounded-full transition-colors"
            (click)="checkByUser()"
            matTooltip="Approve document"
            matTooltipPosition="above"
            aria-label="Approve document"
            style="width: 56px; height: 56px"
        >
            <mat-icon
                svgIcon="verified"
                class="text-gray-500"
            ></mat-icon>
        </button>

        <!-- New Button: Only visible if user.role is 'checker' -->
        <button
            *ngIf="user.role === 'checker'"
            class="bg-white shadow-lg flex items-center justify-center hover:bg-blue-50 p-2 rounded-full transition-colors"
            (click)="confirmByUser()"
            matTooltip="Receive document"
            matTooltipPosition="above"
            aria-label="Receive document"
            style="width: 56px; height: 56px"
        >
            <mat-icon
                svgIcon="verified"
                class="text-green-500"
            ></mat-icon>
        </button>

        <button
        class="bg-white shadow-lg flex items-center justify-center hover:bg-blue-50 p-2 rounded-full transition-colors"
        (click)="pdfForm()"
        matTooltip="Generate PDF form"
        matTooltipPosition="above"
        aria-label="Generate PDF form"
        style="width: 56px; height: 56px"
    >
        <img class="h-8 w-6" src="assets/images/svgs/pdf-svgrepo-com.svg" />
    </button>
    </div>
</div>
